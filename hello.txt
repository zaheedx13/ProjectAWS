# ====================== DEPLOY INDEX.HTML USING AWS EC2 ======================

# STEP 1: Create EC2 Instance
# Do this: Login to AWS Academy → Go to Modules → Launch AWS Academy Lab → Click Start Lab
# Wait for AWS status to turn GREEN
# Click "AWS" button → Search for "EC2" → Click "EC2"
# Click "Launch Instance"
# Do this: Give name = ubuntu
# Select OS = Ubuntu Server (Free Tier Eligible)
# Select Instance Type = t2.micro
# Click "Create new key pair" → Give a name → Click "Create key pair"
# (Do this: Save the .pem file safely on your system)
# Scroll to Network settings → Do this: Check HTTP + HTTPS checkboxes
# Keep Storage = 8GB
# Click "Launch Instance"
# Click "Instances" on left menu
# Wait until status shows 2/2 checks passed
# Do this: Select the instance → Click "Connect"
# Go to SSH tab → Copy the SSH command


# STEP 2: Connect to EC2 through SSH
cd <path-to-your-pem-file>                 # Do this: navigate to where pem file is stored
ssh -i "<key-name>.pem" ubuntu@<public-ip> # Do this: paste the copied SSH command here
                                           # Accept connection by typing "yes" if prompted


# STEP 3: Install Required Software on Ubuntu
sudo apt update                            # Updates system package list
sudo apt-get install docker.io             # Installs Docker
sudo apt install git                       # Installs Git
sudo apt install nano                      # Installs Nano editor


# STEP 4: Create index.html and Push to GitHub
# Do this: On local PC create folder Example and create an index.html file
# Do this: Right-click inside folder → Open Git Bash
git init                                   # Initialize git repo
git add .                                  # Stage all files
git commit -m "first commit"               # Commit files
git branch -M main                         # Rename branch to main
git remote add origin <repo-url>           # Link local repo to GitHub
git push -u origin main                    # Push index.html to GitHub

# Do this: Copy repo HTTPS URL from GitHub
git clone <repo-url>                       # Clone repo inside EC2
cd <repo-folder>
ls                                         # Verify index.html is cloned properly


# STEP 5: Create Dockerfile to host HTML on Nginx
nano Dockerfile                            # Do this: create Dockerfile inside EC2

# Paste this inside nano (do this manually):
FROM nginx
COPY . /usr/share/nginx/html

# Do this:
# Press CTRL+O → ENTER → CTRL+X to save and exit


# STEP 6: Build and Run Docker Container
sudo docker build -t mywebapp .            # Build image from Dockerfile
sudo docker run -d -p 80:80 mywebapp       # Run container and map port 80 → browser port

# Do this: Go to EC2 dashboard → Click Instances → Copy Public IPv4
# Open browser and paste:
# http://<public-ip>
# (Do this: Try HTTP instead of HTTPS if needed)


# STEP 7: Stop Container & Terminate Instance
sudo docker ps                             # Shows running containers
sudo docker stop <container-id>            # Stop the container

# Do this: Go to EC2 → Select instance → Instance state → Terminate
# Do this: Click End Lab
# ========================== END OF DEPLOYING index.html ==========================



# ====================== MAVEN WEB JAVA PROJECT DEPLOYMENT IN AWS ======================

# STEP 1 — Launch EC2 Instance
# Do this: Login into AWS Academy → Start Lab → Wait for status to turn GREEN
# Click "AWS" → Search for "EC2" → Click EC2
# Click "Launch Instance"
# Do this: Enter name for instance (example: MavenWebDeployServer)
# Under Application and OS Images → Choose: Ubuntu Server (Free Tier Eligible)
# Instance Type: t2.micro
# Click "Create new key pair" → Give a name → Click Create → Save .pem file safely
# Scroll to Network Settings → Do this: Check/Enable all checkboxes OR allow HTTP, HTTPS
# Storage: keep default 8GB
# Click "Launch Instance"
# On left menu click "Instances"
# Do this: Wait until status → 2/2 checks passed
# Click the instance checkbox → Click CONNECT → SSH tab → Copy SSH command


# STEP 2 — Connect via SSH
cd <path-to-pem-file>                                      # Do this: navigate where .pem exists
ssh -i "<your-key-name>.pem" ubuntu@<public-ip-address>    # Paste SSH command copied from AWS
                                                            # Type "yes" if asked for confirmation


# STEP 3 — Update Instance and Install Required Software
sudo apt update                                            # Update package lists
sudo apt-get install docker.io                             # Install Docker engine
sudo apt install git                                       # Install Git
sudo apt install nano                                      # Install Nano editor


# STEP 4 — Clone Maven Web Project from GitHub
# Do this: Go to your Maven Web project repository → Click Code → Copy HTTPS URL
git clone <your-maven-project-https-url>                   # Clone repo into EC2
cd <cloned-folder-name>                                    # Enter folder
ls                                                          # Verify project files

# If branch isn't main:
git branch -M main                                           # Make main the default branch (if needed)


# STEP 5 — Create Dockerfile for Maven Web Application
# Do this: create Dockerfile inside EC2 project folder
nano Dockerfile

# Paste the following into Dockerfile:
FROM tomcat:9-jdk11
COPY target/*.war /usr/local/tomcat/webapps/

# Do this to save file:
# Press CTRL + O → Enter → CTRL + X


# STEP 6 — Build Docker Image and Run Container
sudo docker build -t mymavenapp .                          # Build app image
sudo docker run -d -p 9090:8080 mymavenapp                 # Run container mapping port 9090 → Tomcat 8080

# Do this: Go to EC2 Instances → Copy Public IPv4 address
# Paste URL in browser:
# http://<public-ip>:9090/<your-project-name>


# STEP 7 — If App Not Loading (Open Required Port)
# Do this: EC2 → Security Groups → Click the group attached to instance
# Click "Edit inbound rules"
# Click "Add rule"
# Set → Custom TCP | Port: 9090 | Source: 0.0.0.0/0
# Click Save
# Do this: refresh browser page to see web app running


# STEP 8 — Stop container and terminate instance when done
sudo docker ps                                               # List running containers
sudo docker stop <container-id>                              # Stop running container

# Do this: Go back to EC2 console → Instance State → Terminate
# Do this: Click "End Lab"

# ====================== END OF MAVEN JAVA WEB DEPLOYMENT ======================

